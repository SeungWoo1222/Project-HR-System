<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">

<th:block layout:fragment="css">
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <style>
        /* 여기에 CSS를 입력 */
    </style>
</th:block>

<div>
    <div>
        <h1>보고서</h1>
        <p th:text="'제목 : ' + ${report.title}">제목</p>
        <p th:text="'내용 : ' + ${report.content}">내용</p>
        <p th:text="'업무 처리 날짜 : ' + ${report.completeDate}">업무 처리 날짜</p>
        <p th:text="'결재 상태 : ' + ${report.status}">결재 상태</p>
        <p th:text="'작성일 : ' + ${report.createdDate}" class="dateTime">작성일</p>
        <p th:if="${report.status == '거절'}" th:text="'거절 사유: ' + ${report.rejectReason}">거절 사유</p>

        <!-- 결재 상태 변경 기능 시작 -->
        <form th:action="@{/admin/request/approve}" method="post">
            <input type="hidden" name="reportId" th:value="${report.reportId}" />
            <div>
                <label for="status">결재 상태:</label>
                <select id="status" name="status" onchange="toggleRejectionReason()">
                    <option value="승인">승인</option>
                    <option value="거절">거절</option>
                </select>
                <button type="submit">결재 상태 변경</button>
            </div>
            <div id="rejectionReasonContainer" style="display: none;">
                <label for="rejectionReason">거절 사유:</label>
                <textarea id="rejectionReason" name="rejectionReason" ></textarea>
            </div>
        </form>
        <!-- 결재 상태 변경 기능 끝 -->

        <!-- 첨부 파일 리스트 표시 -->
        <div th:if="${files != null}">
            <p>첨부 파일:</p>
            <ul>
                <li th:each="file : ${files}">
                    <form th:action="@{'/file/downloadFile'}" method="get">
                        <input type="hidden" name="fileId" th:value="${file.fileId}" />
                        <input type="hidden" name="originalFileName" th:value="${file.originalFileName}" />
                        <button type="submit" th:text="${file.originalFileName}">다운로드</button>

                    </form>
                    <div style="font-size: 10px; color: gray;">
                        업로드 날짜: <span th:text="${file.uploadDate}" class="dateTime"></span>
                        파일 크기: <span th:text="${file.fileSize / 1024} + ' KB'"></span>
                    </div>
                </li>
            </ul>
        </div>

        <button onclick="closeModal()" >목록으로 </button>
    </div>
</div>
</html>
